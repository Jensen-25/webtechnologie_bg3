<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="Login_stylesheet.css">
        <link rel="javascript" href="login_scherm.js">
      <!-- Navigatie bar -->
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../Products_folder/main_products_page.html">Products</a></li>
        <li><a href="../Login_folder/Login_screen.html">Login</a></li>
        <li><a href="../Login_folder/registratiescherm.html">Registration</a></li>
        <li><a href="../FAQ/FAQ.html">FAQ</a></li>
        <li><a href="../Shoppingcart_folder/shoppingcart_page.html">Shopping Cart</a></li>
      </ul>
    </head>
    <body>
      <hr>
          <form action="add_user2.php" method="post" id="registrationForm">
            <h1> REGISTER </h1>
            <div class="login-box">

                <!-- Step 1: Name Section -->
                <div class="tab" id="step1"> Name:
                    <label for="firstname">Firstname</label> <br>
                    <input type="text" name="firstname" id="firstname" required> <br>
        
                    <label for="lastname">Lastname</label> <br>
                    <input type="text" name="lastname" id="lastname" required> <br>

                    <div style="float:right">
                      <button type="button" onclick="validateAndNext(1, ['firstname', 'lastname'], ['text', 'text'])">Next</button>
                    </div>  
                </div>
                
                <!-- Step 2: Contact Section -->
                <div class="tab" id="step2"> Contact:
                    <label for="email">Email </label> <br>
                    <input type="text" name="email" id="email" required> <br>
        
                    <label for="phonenumber">Phonenumber</label> <br>
                    <input type="text" name="phonenumber" id="phonenumber" required> <br>  

                    <div style="float:right">
                      <button type="button" onclick="prevStep(2)">Previous</button>
                      <button type="button" onclick="validateAndNext(2, ['email', 'phonenumber'], ['email', 'text'])">Next</button>
                    </div>
                </div>
            
                <!-- Step 3: Address Section -->
                <div class="tab" id="step3"> Adress:
                    <label for="postalcode">Postalcode</label> <br>
                    <input type="text" name="postalcode" id="postalcode" required> <br>
        
                    <label for="housenumber">Housenumber</label> <br>
                    <input type="text" name="housenumber" id="housenumber" required> <br> 

                    <div style="float:right">
                      <button type="button" onclick="prevStep(3)">Previous</button>
                      <button type="button" onclick="validateAndNext(3, ['postalcode', 'housenumber'], ['text', 'text'])">Next</button>
                    </div>
                </div>
                
                <!-- Step 4: Account Info Section -->
                <div class="tab" id="step4"> Account info:
                    <label for="username">Username</label> <br>
                    <input type="text" name="username" id="username" required> <br>
        
                    <label for="password">Password</label> <br>
                    <input type="password" name="password" id="password" required> <br>
        
                    <label for="password_2">Repeat Password</label> <br>
                    <input type="password" name="password_2" id="password_2" required> <br>

                    <div style="float:right">
                      <button type="button" onclick="prevStep(4)">Previous</button>
                      <button type="button" onclick="validateAndNext(4, ['username', 'password', 'password_2'], ['text', 'password', 'password'])">Submit</button>
                    </div>
                </div>
                
                <!-- Circles indicating form steps -->
                <div style="text-align:center;margin-top:50px;">
                    <div class="circle" id="circle1"></div>
                    <div class="circle" id="circle2"></div>
                    <div class="circle" id="circle3"></div>
                    <div class="circle" id="circle4"></div>
                </div>  
            </div>  
        </form>
    </body>
</html>

<script>

  var currentStep = 1

  // displaying the current tab correctly in a black with the Progress circles
  function showTab(step) {
      var tabs = document.querySelectorAll('.tab');
      tabs.forEach(function(tab) {
          tab.style.display = 'none';
      });
      document.getElementById('step' + step).style.display = 'block';
      currentStep = step;
      updateProgressIndicator();
  }

  // Moving to the next tab when clicking the button
  function nextStep(currentStep) {
      showTab(currentStep + 1);
  }

  // Moving to the previous tab when clicking the button
  function prevStep(currentStep) {
      showTab(currentStep - 1);
  }

  // Validate the input and raising an error if the input is wrong, then moving to the next tab
  function validateAndNext(currentStep, inputIds, inputTypes) {
      var isValid = true;

      // Looping over all the inputs and validating each one
      for (var i = 0; i < inputIds.length; i++) {
          var inputId = inputIds[i];
          var inputType = inputTypes[i];
          var inputValue = document.getElementById(inputId).value;
          var password1 = document.getElementById("password").value;
          var password2 = document.getElementById("password_2").value;

          // Checking if a box is not empty or an email is not valid or a password is not valid
          if (inputValue.trim() === '' || (inputType === 'email' && !validateEmail(inputValue)) || 
          (inputType === 'password' && !validatePassword(inputValue))) {
              isValid = false;
              alert('Please enter a valid ' + inputId + '.');
              break;
          }

        //   Alert user if the password and repeat password do not match
          if (!ValidateMatchingPasswords(password1, password2)) {
            isValid = false;
            alert('Your passwords do not match');
            break;
          }
      }

      // Submitting the form or moving to the next tab
      if (isValid) {
          if (currentStep === 4) {
              // If it's the last step, submit the form
              document.getElementById('registrationForm').submit();
          } else {
              // Otherwise, proceed to the next step
              nextStep(currentStep);
          }
      }
  }

  // Simple email validation using a regular expression
  function validateEmail(email) {
      // Deze emailRegex is van het internet gehaald op w3schools.com
      var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
  }

  function validatePassword(password) {
    // Minimum length of 8 characters
    if (password.length < 8) {
        return false;
    }

    // Should contain at least one uppercase letter
    if (!/[A-Z]/.test(password)) {
        return false;
    }

    // Should contain at least one lowercase letter
    if (!/[a-z]/.test(password)) {
        return false;
    }

    // Should contain at least one digit
    if (!/\d/.test(password)) {
        return false;
    }

    // Should contain at least one special character (you can customize this set)
    if (!/[!@#$%^&*()_+{}\[\]:;<>,.?~\\/-]/.test(password)) {
        return false;
    }

    // All criteria met, so the password is valid
    return true;
}

// Check if the password and repeat password are the same
function ValidateMatchingPasswords(password1, password2) {
    return password1 === password2;
  }

  // Updating the circles underneath the form to show the progress
  function updateProgressIndicator() {
      var circles = document.querySelectorAll('.circle');
      circles.forEach(function(circle, index) {
          if (index < currentStep) {
              circle.classList.add('filled');
          } else {
              circle.classList.remove('filled');
          }
      });
  }

  // Start with the first tab
  showTab(1);
</script>
